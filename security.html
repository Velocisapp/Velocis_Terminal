<!DOCTYPE html>
<html>
<head>
    <style>
    body { margin: 0; background: #010406; overflow: hidden; font-family: 'Courier New', monospace; width: 100vw; height: 100vh; }
    canvas { display: block; width: 100%; height: 100%; }
    #ui { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    
    /* Optimized for Mobile */
    #header-box { 
        position: absolute; 
        top: 20px; 
        left: 5%; 
        border: 2px solid #FFD700; 
        padding: 15px; 
        background: rgba(0,20,20,0.95); 
        width: 85%; /* Fits within mobile screen width */
        box-sizing: border-box;
    }
    
    #brand-title { color: #FFD700; font-size: 18px; font-weight: 900; }
    #clock { color: #FFD700; font-size: 24px; font-weight: bold; }
    
    @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
    @keyframes alertBoxPulse { 
        0% { border-width: 2px; box-shadow: 0 0 5px #FF3131; } 
        50% { border-width: 5px; box-shadow: 0 0 20px #FF3131; } 
        100% { border-width: 2px; box-shadow: 0 0 5px #FF3131; } 
    }
</style>

<div id="ui">
    <div id="header-box">
        <div id="brand-title">VELOCIS™ SECURITY HUB</div>
        <div style="height: 2px; background: #FFD700; margin: 10px 0;"></div>
        <div id="clock">TIME: --:--:--</div>
    </div>
    
    <div style="position: absolute; bottom: 0; width: 100%; height: 60px; background: rgba(60, 0, 0, 0.95); border-top: 4px solid #FF3131; display: flex; align-items: center; overflow: hidden;">
        <div id="ticker-text" style="white-space: nowrap; color: #FF3131; font-weight: 900; font-size: 25px; animation: marquee 10s linear infinite;">
            TERMINAL 3 | SECURITY STATUS: ALPHA | VELOCIS™ HUB
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('engine');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;

    let flightHistory = ["FLIGHT: EK-CDG", "FLIGHT: EK-SFO", "FLIGHT: EK-LHR", "FLIGHT: EK-JFK", "FLIGHT: EK-SIN"];
    const gates = [
        { id: "B12", pos: 0.1, status: "BOARDING" }, { id: "B14", pos: 0.25, status: "BOARDING" },
        { id: "A05", pos: 0.4, status: "ON TIME" }, { id: "A07", pos: 0.55, status: "FINAL CALL" },
        { id: "C01", pos: 0.7, status: "ON TIME" }, { id: "C03", pos: 0.85, status: "BOARDING" }
    ];

    const activeIdx = [0, 1, 3, 5];
    const dots = Array.from({ length: 55 }, () => ({
        x: Math.random() * canvas.width, y: canvas.height + 50,
        speed: 0.7 + Math.random() * 0.9,
        targetGate: activeIdx[Math.floor(Math.random() * activeIdx.length)]
    }));

    function drawSleekArrow(x, y, color, dark, paxCount) {
        ctx.save(); ctx.translate(x, y);
        const pulse = (paxCount > 12) ? Math.abs(Math.sin(Date.now() / 250)) * 15 : 0;
        ctx.shadowBlur = 10 + pulse; ctx.shadowColor = color;
        ctx.fillStyle = dark; ctx.beginPath();
        ctx.moveTo(-50, 10); ctx.lineTo(0, -65); ctx.lineTo(50, 10); ctx.lineTo(25, 10); ctx.lineTo(25, 75); ctx.lineTo(-25, 75); ctx.lineTo(-25, 10); ctx.fill();
        ctx.translate(0, -10);
        let faceGrd = ctx.createLinearGradient(0, -60, 0, 70);
        faceGrd.addColorStop(0, '#FFFFFF'); faceGrd.addColorStop(0.3, color); faceGrd.addColorStop(1, dark);
        ctx.fillStyle = faceGrd; ctx.beginPath();
        ctx.moveTo(-50, 10); ctx.lineTo(0, -65); ctx.lineTo(50, 10); ctx.lineTo(25, 10); ctx.lineTo(25, 70); ctx.lineTo(-25, 70); ctx.lineTo(-25, 10); ctx.fill();
        ctx.globalAlpha = 0.3; ctx.fillStyle = '#FFFFFF';
        ctx.beginPath(); ctx.ellipse(0, -20, 20, 8, 0, 0, Math.PI * 2); ctx.fill();
        ctx.restore();
    }

    function draw() {
        ctx.fillStyle = '#010406'; ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 1. DYNAMIC HEADER ALERT LOGIC
        const hasFinalCall = gates.some(g => g.status === "FINAL CALL");
        const hb = document.getElementById('header-box');
        const clk = document.getElementById('clock');
        const bt = document.getElementById('brand-title');
        const hl = document.getElementById('header-line');
        const tk = document.getElementById('ticker-text');

        if (hasFinalCall) {
            hb.style.animation = 'alertBoxPulse 1s infinite ease-in-out';
            hb.style.borderColor = '#FF3131';
            clk.style.color = '#FF3131'; bt.style.color = '#FF3131'; hl.style.background = '#FF3131';
            tk.innerText = "CRITICAL ALERT: FINAL CALL AT GATE A07 | SECURE PERIMETER IMMEDIATELY";
        } else {
            hb.style.animation = 'none';
            hb.style.borderColor = '#FFD700';
            clk.style.color = '#FFD700'; bt.style.color = '#FFD700'; hl.style.background = '#FFD700';
            tk.innerText = "TERMINAL 3 | SECURITY STATUS: ALPHA | SYSTEM ACTIVE | VELOCIS™ HUB";
        }

        gates.forEach((g, idx) => {
            const gx = canvas.width * g.pos; const gy = canvas.height * 0.75;
            let color = (g.status === "ON TIME") ? '#FFD700' : '#FF3131';
            let dark = (g.status === "ON TIME") ? '#8B6B00' : '#8B0000';
            const pGrd = ctx.createLinearGradient(gx-60, 0, gx+60, 0);
            pGrd.addColorStop(0, 'rgba(0, 255, 255, 0.0)'); pGrd.addColorStop(0.5, 'rgba(0, 255, 255, 0.45)'); pGrd.addColorStop(1, 'rgba(0, 255, 255, 0.0)');
            ctx.fillStyle = pGrd; ctx.fillRect(gx-60, 0, 120, gy);
            const paxCount = dots.filter(d => d.targetGate === idx).length;
            drawSleekArrow(gx, gy - 320 + Math.sin(Date.now()/400)*12, color, dark, paxCount);
            ctx.textAlign = "center"; ctx.fillStyle = '#FFFFFF'; ctx.font = '900 32px Courier New'; ctx.fillText("GATE", gx, 335); 
            ctx.fillStyle = color; ctx.font = '900 75px Courier New'; ctx.fillText(g.id, gx, 395);
            ctx.font = 'bold 28px monospace'; ctx.fillText(g.status, gx, 440);
        });

        dots.forEach(d => {
            const gx = canvas.width * gates[d.targetGate].pos; const gy = canvas.height * 0.75;
            let dx = gx - d.x; let dy = gy - d.y;
            let dist = Math.sqrt(dx*dx + dy*dy);
            if (dist > 60) { d.x += (dx/dist)*d.speed; d.y += (dy/dist)*d.speed; }
            else { d.x += (Math.random()-0.5)*1.5; d.y += (Math.random()-0.5)*1.5; }
            ctx.fillStyle = '#00FFFF'; ctx.beginPath(); ctx.arc(d.x, d.y, 5, 0, Math.PI*2); ctx.fill();
        });

        flightHistory.forEach((f, i) => {
            const lx = canvas.width - 500; const ly = canvas.height - 350 - (i * 70);
            ctx.fillStyle = 'rgba(0, 20, 20, 0.95)'; ctx.fillRect(lx, ly, 470, 60);
            ctx.strokeStyle = '#FFD700'; ctx.lineWidth = 4; ctx.strokeRect(lx, ly, 470, 60);
            ctx.fillStyle = '#00FFFF'; ctx.font = '900 26px Courier New'; ctx.textAlign = 'right';
            ctx.fillText(f, canvas.width - 65, ly + 40);
        });
        requestAnimationFrame(draw);
    }
    draw();
    setInterval(() => { document.getElementById('clock').innerText = `TIME: ${new Date().toLocaleTimeString('en-GB')}`; }, 1000);
</script>
</body>
</html>
